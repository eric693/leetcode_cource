<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>48. Rotate Image - LeetCode 學習平台</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f8fafc; line-height: 1.8; color: #334155; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; padding: 40px; border-radius: 16px; margin-bottom: 30px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .back-btn { display: inline-block; color: white; text-decoration: none; background: rgba(255,255,255,0.2); padding: 10px 20px; border-radius: 8px; margin-bottom: 20px; transition: all 0.3s; }
        .back-btn:hover { background: rgba(255,255,255,0.3); }
        .problem-title { font-size: 2.5em; font-weight: 800; margin-bottom: 15px; }
        .difficulty { display: inline-block; background: rgba(255,255,255,0.3); padding: 8px 20px; border-radius: 20px; font-weight: 600; font-size: 0.9em; }
        .content-section { background: white; padding: 40px; border-radius: 16px; margin-bottom: 25px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .section-title { font-size: 1.8em; color: #1e293b; margin-bottom: 25px; font-weight: 700; padding-bottom: 10px; border-bottom: 3px solid #f59e0b; }
        .description { font-size: 1.1em; line-height: 1.9; color: #475569; margin-bottom: 20px; }
        .example-box { background: #fef3c7; border-left: 4px solid #f59e0b; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .example-title { font-weight: 700; color: #92400e; margin-bottom: 10px; font-size: 1.1em; }
        .approach-box { background: #eff6ff; border-left: 4px solid #3b82f6; padding: 25px; border-radius: 8px; margin: 25px 0; }
        .approach-title { font-weight: 700; color: #1e40af; margin-bottom: 15px; font-size: 1.3em; }
        .complexity-box { background: #fef3c7; border-left: 4px solid #f59e0b; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .complexity-item { margin: 10px 0; font-weight: 600; color: #92400e; }
        .language-tabs { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .tab-btn { padding: 12px 28px; border: 2px solid #f59e0b; background: white; color: #f59e0b; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s; font-size: 1em; }
        .tab-btn:hover { background: #fef3c7; }
        .tab-btn.active { background: #f59e0b; color: white; }
        .code-container { display: none; margin-top: 20px; }
        .code-container.active { display: block; }
        pre { background: #282c34 !important; padding: 25px !important; border-radius: 12px; overflow-x: auto; margin: 0; }
        code { font-family: 'Fira Code', 'Consolas', monospace; font-size: 0.95em; line-height: 1.6; }
        ol, ul { margin-left: 30px; margin-top: 15px; }
        li { margin: 12px 0; line-height: 1.8; }
        strong { color: #1e293b; font-weight: 700; }
        .visual-box { background: #f0f9ff; border: 2px solid #3b82f6; padding: 20px; border-radius: 8px; margin: 20px 0; }
        
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .header { padding: 25px; }
            .problem-title { font-size: 1.8em; }
            .content-section { padding: 25px; }
            .tab-btn { padding: 10px 20px; font-size: 0.9em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="../index.html" class="back-btn">← 返回題目列表</a>
            <div class="problem-title">48. Rotate Image</div>
            <span class="difficulty">Medium</span>
        </div>

        <div class="content-section">
            <h2 class="section-title">題目描述</h2>
            <div class="description">
                <p>給定一個 <code>n × n</code> 的二維矩陣 <code>matrix</code> 表示一個圖像。請你將圖像<strong>順時針旋轉 90 度</strong>。</p>
                <p style="margin-top: 15px;">你必須在<strong>原地</strong>旋轉圖像，這意味著你需要直接修改輸入的二維矩陣。<strong>請不要</strong>使用另一個矩陣來旋轉圖像。</p>
            </div>

            <div class="example-box">
                <div class="example-title">範例 1:</div>
                <pre><code>輸入: matrix = [[1,2,3],[4,5,6],[7,8,9]]
輸出: [[7,4,1],[8,5,2],[9,6,3]]

視覺化:
旋轉前:        旋轉後:
1 2 3          7 4 1
4 5 6    →     8 5 2
7 8 9          9 6 3</code></pre>
            </div>

            <div class="example-box">
                <div class="example-title">範例 2:</div>
                <pre><code>輸入: matrix = [[5,1,9,11],[2,4,8,10],[13,3,6,7],[15,14,12,16]]
輸出: [[15,13,2,5],[14,3,4,1],[12,6,8,9],[16,7,10,11]]

視覺化:
旋轉前:           旋轉後:
5  1  9  11       15 13 2  5
2  4  8  10   →   14 3  4  1
13 3  6  7        12 6  8  9
15 14 12 16       16 7  10 11</code></pre>
            </div>

            <div class="example-box">
                <div class="example-title">限制條件:</div>
                <pre><code>n == matrix.length == matrix[i].length
1 <= n <= 20
-1000 <= matrix[i][j] <= 1000</code></pre>
            </div>
        </div>

        <div class="content-section">
            <h2 class="section-title">解題思路</h2>
            
            <div class="approach-box">
                <div class="approach-title">核心觀察</div>
                <p>順時針旋轉 90 度的規律：</p>
                <ul>
                    <li>第一行變成最後一列</li>
                    <li>第二行變成倒數第二列</li>
                    <li>matrix[i][j] → matrix[j][n-1-i]</li>
                    <li>需要原地操作</li>
                </ul>
                <p style="margin-top: 15px; color: #f59e0b; font-weight: 600;">
                    關鍵：轉置 + 水平翻轉 = 順時針旋轉 90°
                </p>
            </div>
            
            <div class="approach-box">
                <div class="approach-title">方法一：轉置 + 翻轉（推薦）⭐⭐⭐</div>
                <p>將旋轉分解為兩個簡單操作。</p>
                
                <p style="margin-top: 15px;"><strong>核心思想：</strong></p>
                <ol>
                    <li><strong>步驟 1：轉置矩陣</strong>
                        <ul style="margin-top: 8px;">
                            <li>matrix[i][j] ↔ matrix[j][i]</li>
                            <li>沿主對角線翻轉</li>
                        </ul>
                    </li>
                    <li><strong>步驟 2：水平翻轉每一行</strong>
                        <ul style="margin-top: 8px;">
                            <li>reverse(matrix[i])</li>
                            <li>左右對調</li>
                        </ul>
                    </li>
                </ol>
                
                <div class="visual-box">
                    <p><strong>視覺化範例：3×3 矩陣</strong></p>
                    <pre style="background: white; padding: 15px; border-radius: 5px; margin-top: 10px;"><code>原始矩陣:
1 2 3
4 5 6
7 8 9

步驟 1：轉置（沿主對角線翻轉）
對於所有 i < j，交換 matrix[i][j] 和 matrix[j][i]

交換 matrix[0][1] 和 matrix[1][0]: 2 ↔ 4
交換 matrix[0][2] 和 matrix[2][0]: 3 ↔ 7
交換 matrix[1][2] 和 matrix[2][1]: 6 ↔ 8

轉置後:
1 4 7
2 5 8
3 6 9

步驟 2：水平翻轉每一行
第 0 行: [1,4,7] → [7,4,1]
第 1 行: [2,5,8] → [8,5,2]
第 2 行: [3,6,9] → [9,6,3]

最終結果:
7 4 1
8 5 2
9 6 3 ✓</code></pre>
                </div>
                
                <p style="margin-top: 15px;"><strong>為什麼這樣可行？</strong></p>
                <pre style="background: #f1f5f9; padding: 15px; border-radius: 8px; margin-top: 10px;"><code>原位置: (i, j)

步驟 1 轉置: (i, j) → (j, i)
步驟 2 水平翻轉: (j, i) → (j, n-1-i)

總效果: (i, j) → (j, n-1-i)

這正是順時針旋轉 90° 的公式！</code></pre>
            </div>

            <div class="approach-box">
                <div class="approach-title">方法二：逐圈旋轉</div>
                <p>從外圈到內圈，每次旋轉四個元素。</p>
                
                <p style="margin-top: 15px;"><strong>核心思想：</strong></p>
                <ul>
                    <li>一圈一圈處理</li>
                    <li>每次同時旋轉 4 個位置</li>
                    <li>使用臨時變數保存</li>
                </ul>
                
                <div class="visual-box">
                    <p><strong>4 個位置的旋轉：</strong></p>
                    <pre style="background: white; padding: 15px; border-radius: 5px; margin-top: 10px;"><code>對於位置 (i, j)，同時旋轉 4 個位置:

(i, j)          → (j, n-1-i)      上 → 右
(j, n-1-i)      → (n-1-i, n-1-j)  右 → 下
(n-1-i, n-1-j)  → (n-1-j, i)      下 → 左
(n-1-j, i)      → (i, j)          左 → 上

使用臨時變數:
temp = top
top = left
left = bottom
bottom = right
right = temp</code></pre>
                </div>
            </div>
        </div>

        <div class="content-section">
            <h2 class="section-title">程式碼實現</h2>
            
            <div class="language-tabs">
                <button class="tab-btn active" onclick="showLanguage('python')">Python</button>
                <button class="tab-btn" onclick="showLanguage('cpp')">C++</button>
                <button class="tab-btn" onclick="showLanguage('java')">Java</button>
            </div>

            <div id="python" class="code-container active">
                <pre><code class="language-python">class Solution:
    def rotate(self, matrix: List[List[int]]) -> None:
        """
        方法一：轉置 + 翻轉（推薦）
        時間複雜度: O(n²)
        空間複雜度: O(1)
        
        Do not return anything, modify matrix in-place instead.
        """
        n = len(matrix)
        
        # 步驟 1：轉置矩陣
        for i in range(n):
            for j in range(i + 1, n):
                matrix[i][j], matrix[j][i] = matrix[j][i], matrix[i][j]
        
        # 步驟 2：水平翻轉每一行
        for i in range(n):
            matrix[i].reverse()
            # 或者: matrix[i] = matrix[i][::-1]
    
    def rotate_v2(self, matrix: List[List[int]]) -> None:
        """
        方法二：逐圈旋轉
        時間複雜度: O(n²)
        空間複雜度: O(1)
        """
        n = len(matrix)
        
        # 處理每一圈
        for layer in range(n // 2):
            first = layer
            last = n - 1 - layer
            
            # 處理當前圈的每個元素
            for i in range(first, last):
                offset = i - first
                
                # 保存上邊
                top = matrix[first][i]
                
                # 左 → 上
                matrix[first][i] = matrix[last-offset][first]
                
                # 下 → 左
                matrix[last-offset][first] = matrix[last][last-offset]
                
                # 右 → 下
                matrix[last][last-offset] = matrix[i][last]
                
                # 上 → 右
                matrix[i][last] = top</code></pre>
            </div>

            <div id="cpp" class="code-container">
                <pre><code class="language-cpp">#include &lt;vector&gt;
#include &lt;algorithm&gt;
using namespace std;

class Solution {
public:
    /**
     * 方法一：轉置 + 翻轉
     * 時間複雜度: O(n²)
     * 空間複雜度: O(1)
     */
    void rotate(vector<vector<int>>& matrix) {
        int n = matrix.size();
        
        // 轉置
        for (int i = 0; i < n; i++) {
            for (int j = i + 1; j < n; j++) {
                swap(matrix[i][j], matrix[j][i]);
            }
        }
        
        // 水平翻轉
        for (int i = 0; i < n; i++) {
            reverse(matrix[i].begin(), matrix[i].end());
        }
    }
};</code></pre>
            </div>

            <div id="java" class="code-container">
                <pre><code class="language-java">class Solution {
    /**
     * 方法一：轉置 + 翻轉
     * 時間複雜度: O(n²)
     * 空間複雜度: O(1)
     */
    public void rotate(int[][] matrix) {
        int n = matrix.length;
        
        // 轉置
        for (int i = 0; i < n; i++) {
            for (int j = i + 1; j < n; j++) {
                int temp = matrix[i][j];
                matrix[i][j] = matrix[j][i];
                matrix[j][i] = temp;
            }
        }
        
        // 水平翻轉
        for (int i = 0; i < n; i++) {
            int left = 0, right = n - 1;
            while (left < right) {
                int temp = matrix[i][left];
                matrix[i][left] = matrix[i][right];
                matrix[i][right] = temp;
                left++;
                right--;
            }
        }
    }
}</code></pre>
            </div>
        </div>

        <div class="content-section">
            <h2 class="section-title">複雜度分析</h2>
            <div class="complexity-box">
                <div class="complexity-item">時間複雜度: O(n²)</div>
                <p style="color: #78716c; margin: 10px 0;">
                    需要訪問每個元素，矩陣有 n² 個元素。
                </p>
                
                <div class="complexity-item" style="margin-top: 20px;">空間複雜度: O(1)</div>
                <p style="color: #78716c; margin: 10px 0;">
                    原地操作，只使用常數額外空間。
                </p>
            </div>
        </div>

        <div class="content-section">
            <h2 class="section-title">重點提示</h2>
            <div class="complexity-box">
                <ul>
                    <li><strong>旋轉的數學原理：</strong>
                        <ul style="margin-top: 8px;">
                            <li>順時針 90°：(i,j) → (j, n-1-i)</li>
                            <li>逆時針 90°：(i,j) → (n-1-j, i)</li>
                            <li>180°：(i,j) → (n-1-i, n-1-j)</li>
                        </ul>
                    </li>
                    <li><strong>為什麼轉置+翻轉可行？</strong>
                        <ul style="margin-top: 8px;">
                            <li>轉置：行列互換</li>
                            <li>水平翻轉：左右對調</li>
                            <li>組合效果等於順時針旋轉</li>
                        </ul>
                    </li>
                    <li><strong>轉置時的注意事項：</strong>
                        <ul style="margin-top: 8px;">
                            <li>只需處理上三角（j > i）</li>
                            <li>避免重複交換</li>
                            <li>對角線元素不需要交換</li>
                        </ul>
                    </li>
                    <li><strong>兩種方法比較：</strong>
                        <ul style="margin-top: 8px;">
                            <li>轉置+翻轉：代碼簡潔，易理解</li>
                            <li>逐圈旋轉：更直接，但複雜</li>
                            <li>面試推薦前者</li>
                        </ul>
                    </li>
                    <li><strong>其他旋轉方式：</strong>
                        <ul style="margin-top: 8px;">
                            <li>逆時針 90°：轉置 + 垂直翻轉</li>
                            <li>或：垂直翻轉 + 轉置</li>
                        </ul>
                    </li>
                    <li><strong>常見錯誤：</strong>
                        <ul style="margin-top: 8px;">
                            <li>轉置時處理整個矩陣（會重複）</li>
                            <li>忘記原地修改</li>
                            <li>翻轉方向錯誤</li>
                        </ul>
                    </li>
                    <li><strong>邊界情況：</strong>
                        <ul style="margin-top: 8px;">
                            <li>1×1 矩陣</li>
                            <li>2×2 矩陣</li>
                            <li>奇數 vs 偶數大小</li>
                        </ul>
                    </li>
                    <li><strong>面試技巧：</strong>
                        <ul style="margin-top: 8px;">
                            <li>畫圖展示旋轉過程</li>
                            <li>說明數學公式</li>
                            <li>解釋為什麼兩步可以達成</li>
                            <li>測試小矩陣</li>
                        </ul>
                    </li>
                    <li><strong>Python 技巧：</strong>
                        <ul style="margin-top: 8px;">
                            <li>list.reverse() 原地翻轉</li>
                            <li>[::-1] 創建新列表</li>
                            <li>優先使用 reverse()</li>
                        </ul>
                    </li>
                    <li><strong>擴展思考：</strong>
                        <ul style="margin-top: 8px;">
                            <li>如何旋轉任意角度？</li>
                            <li>如何旋轉長方形矩陣？</li>
                            <li>如何進行 3D 旋轉？</li>
                        </ul>
                    </li>
                    <li><strong>實際應用：</strong>圖像處理、遊戲開發、計算機圖形學</li>
                    <li><strong>記憶口訣：</strong>「先轉置後翻轉，順時針轉九十度」</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        hljs.highlightAll();
        
        function showLanguage(lang) {
            document.querySelectorAll('.code-container').forEach(container => {
                container.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(lang).classList.add('active');
            event.target.classList.add('active');
        }
    </script>
</body>
</html>